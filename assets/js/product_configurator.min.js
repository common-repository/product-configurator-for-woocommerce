var PC=PC||{};PC.fe=PC.fe||{},PC.fe.models=PC.fe.models||{},PC.actionParameter="pc_get_data",function(a,n){"use strict";PC.fe.config=PC.fe.config||PC_config.config,PC.fe.config=n.extend({},PC.fe.config),PC.fe.products_content=PC.fe.products_content||[],a(function(){function e(e){e.preventDefault(),PC.fe.config.current_language&&(PC.fe.lang=PC.fe.config.current_language,PC.utils.add_language_filters(PC.fe.lang));var t,o=a(e.target);if((o=o.is(".configure-product")?o:o.closest(".configure-product")).data("product_id")?(t=o.data("product_id"),o.is(".is-shortcode")?PC.fe.is_using_shortcode=!0:PC.fe.is_using_shortcode=!1):a('*[name="add-to-cart"]').length&&(PC.fe.is_using_shortcode=!1,t=a('*[name="add-to-cart"]').val()),t){var n=!1;o.data("preset")&&((!PC.fe.initial_preset||PC.fe.initial_preset&&PC.fe.initial_preset!=o.data("preset"))&&(n=!0),PC.fe.initial_preset=o.data("preset")),"mkl/pc/inline-init"==e.type&&(PC.fe.inline=!0,PC.fe.inlineTarget=e.target);try{PC.fe.open(t,t,o,n)}catch(e){console.error("we had an error: ",e),console.trace(e)}}else console.log("No product ID was found")}function t(e){e.model.get("angle_switch")&&"no"!=e.model.get("angle_switch")&&!1!==e.model.get("cshow")&&(e=PC.fe.angles.get(e.model.get("angle_switch")))&&!e.get("active")&&(e.collection.each(function(e){e.set("active",!1)}),e.set("active",!0))}PC.utils._isTouch()&&a("body").addClass("is-touch"),PC.utils._isMobile()&&a("body").addClass("is-mobile"),PC.fe.config.open_configurator||new URLSearchParams(location.search).has("open_configurator")&&(PC.fe.config.open_configurator=!0),a("body").on("keydown",function(e){a(this).hasClass("keyboard-navigation")||"Tab"!=e.key||e.ctrlKey||a(this).addClass("keyboard-navigation")}),a("body").on("click",function(e){a(this).hasClass("keyboard-navigation")&&a(this).removeClass("keyboard-navigation")}),PC.fe.product_type=PC.fe.product_type||"simple",a("body").on("click",".configure-product-redq_rental",e),a("body").on("click",".configure-product-simple",e),a("body").on("mkl/pc/inline-init",".mkl-configurator-inline",e),a("form.cart").each(function(e,t){a("body").is(".is_configurable")&&!a("body").is(".enable-add-to-cart")&&a(t).find('button[name="add-to-cart"]').prop("disabled","disabled"),a(t).on("submit",function(e){a("input[name=pc_configurator_data]").val(PC.fe.save_data.save()),""==a("input[name=pc_configurator_data]").val()&&(e.preventDefault(),console.log("empty data"))})}),wp.hooks.addAction("PC.fe.start","mkl/product_configurator",function(e){var t;a('form.cart button[name="add-to-cart"]').prop("disabled",!1),a(document).on("change","form.cart input[name=quantity], .mkl_pc .form input[name=quantity]",function(e){var o=a(this).val();a("form.cart input[name=quantity], .mkl_pc .form input[name=quantity]").each(function(e,t){a(t).val(o)})}),"object"==typeof ctFrontend&&ctFrontend.hasOwnProperty("handleEntryPoints")&&ctFrontend.hasOwnProperty("allFrontendEntryPoints")&&ctFrontend.handleEntryPoints(ctFrontend.allFrontendEntryPoints),a.nmThemeInstance&&a.nmThemeInstance.quantityInputsBindButtons&&a.nmThemeInstance.quantityInputsBindButtons(a(".mkl_pc")),wp.hooks.applyFilters("PC.fe.reset.on.start",!0)&&PC.fe.contents.content.resetConfig(),PC_config.config.swipe_to_change_view&&1<PC.fe.angles.length&&(t={triggerOnTouchEnd:!0,swipeStatus:function(e,t,o,n){var a=PC.fe.angles.findWhere({active:!0}),i=PC.fe.angles.indexOf(a),r=!1,c=0<=i-1&&PC.fe.angles.at(i-1),i=PC.fe.angles.at(i+1);"end"==t&&("right"==o&&c&&(r=c),"left"==o&&i&&(r=i),a)&&r&&(a.set("active",!1),r.set("active",!0))},allowPageScroll:"vertical",threshold:75},a(".mkl_pc_layers").swipe(t))},20),wp.hooks.addAction("PC.fe.start","mkl/product_configurator",function(e){setTimeout(function(){PC_config.config.load_config_content&&Array.isArray(PC_config.config.load_config_content)?PC.fe.setConfig(PC_config.config.load_config_content):PC.fe.initial_preset&&PC.fe.setConfig(PC.fe.initial_preset)},300)},50),wp.hooks.addAction("PC.fe.start","mkl/product_configurator",function(e){setTimeout(function(){wp.hooks.addAction("PC.fe.layer.activate","mkl/product_configurator",t,20),wp.hooks.addAction("PC.fe.choice.activate","mkl/product_configurator",t,20)},310)},55),wp.hooks.addAction("PC.fe.layer.activate","mkl/product_configurator",function(e){"full-screen"===e.model.get("display_mode")&&a("body").addClass("pc-full-screenlayer--opened")}),wp.hooks.addAction("PC.fe.layer.deactivate","mkl/product_configurator",function(e){"full-screen"===e.model.get("display_mode")&&a("body").removeClass("pc-full-screenlayer--opened")}),PC_config.config.open_first_layer&&wp.hooks.addAction("PC.fe.start","mkl/product_configurator",function(e){e=e.$(".layer-item:visible").first();e.parent().is(".display-mode-dropdown")||e.trigger("click")},60),a(".mkl-configurator-inline").trigger("mkl/pc/inline-init"),PC.fe.config.open_configurator&&1==PC.fe.config.open_configurator&&!a(".mkl-configurator-inline").length&&a(".configure-product-simple").first().trigger("click")}),PC.fe.init=function(e,t,o){PC.fe.is_using_shortcode&&(this.options={}),PC.fe.trigger_el=o,t?(this.currentProductData=PC.productData["prod_"+t],this.layers=new PC.layers(PC.productData["prod_"+t].layers),this.angles=new PC.angles(PC.productData["prod_"+t].angles)):(this.currentProductData=PC.productData["prod_"+e],this.layers=new PC.layers(PC.productData["prod_"+e].layers),this.angles=new PC.angles(PC.productData["prod_"+e].angles)),a(o).data("force_form")&&(PC.fe.currentProductData.product_info.force_form=!0),PC.fe.product_type=this.currentProductData.product_info.product_type,o&&o.data("price")?(this.currentProductData.product_info.price=o.data("price"),this.currentProductData.product_info.regular_price=o.data("regular_price"),this.currentProductData.product_info.is_on_sale=1==o.data("is_on_sale")):this.currentProductData.product_info.price=0,("simple"===PC.fe.product_type&&PC.productData["prod_"+e]||"variation"===PC.fe.product_type&&PC.productData["prod_"+e])&&(this.contents=PC.fe.setContent.parse(PC.productData["prod_"+e]),this.modal.$el.trigger("content-is-loaded")),a(document.body).trigger("mkl-pc-init",e,t),wp.hooks.doAction("PC.fe.init",e,t)},PC.fe.open=function(t,o,n,e){PC.fe.opened=!0,wp.hooks.doAction("PC.fe.before_open"),a("body").addClass("configurator_is_opened"),PC.fe.inline&&a("body").addClass("configurator_is_inline"),t==PC.fe.active_product?(this.modal.open(),e&&PC.fe.modal&&PC.fe.modal.resetConfig()):(t!=PC.fe.active_product&&this.modal&&(this.modal.remove(),this.modal=null,wp.hooks.doAction("PC.fe.reset_product")),PC.fe.active_product=t,PC.fe.parent_product=o||t,PC.productData&&PC.productData["prod_"+o]?(this.modal=this.modal||new PC.fe.views.configurator({product_id:t,parent_id:o}),PC.fe.init(t,o,n)):PC.productDataMode&&"json"==PC.productDataMode?wp.hooks.addAction("mkl_pc.product_data.loaded","mkl_pc",function(e){e==t&&(this.modal=this.modal||new PC.fe.views.configurator({product_id:t,parent_id:o}),PC.fe.init(t,o,n))}.bind(this)):n.after(a("<div>Error loading the configurator data</div>")))},PC.fe.close=function(){this.modal&&this.modal.close()},PC.fe.setContent={url:function(){var e=PC.actionParameter;return ajaxurl+"?action="+e+"&data=content&id="+this.id},idAttribute:"product_id",defaults:{product_type:"simple",modified:!1},parse:function(e){wp.hooks.doAction("PC.fe.setContent.parse.before",e);var o=new PC.content_list;return!e instanceof Object||null==e.content||0==e.content||"false"==e.content?o:(a.each(e.content,function(e,t){t=n.clone(t);t.choices&&0<t.choices.length&&PC.fe.layers.get(t.layerId)&&(t.choices=new PC.choices(t.choices,{layer:PC.fe.layers.get(t.layerId)}),o.add(t))}),{content:o})}},PC.fe.getLayerContent=PC.fe.get_layer_content=function(e){return!!PC.fe.contents.content.get(e)&&PC.fe.contents.content.get(e).attributes.choices},PC.fe.get_choice_model=function(e,t){e=PC.fe.get_layer_content(e);return!(!e||!t)&&e.get(t)},PC.fe.fetchContent=function(t){PC.fe.products_content[t]?(this.contents=PC.fe.products_content[t],this.modal.$el.trigger("content-is-loaded","an argument")):(this.modal.$el.show(),this.modal.$el.addClass("loading"),a.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:{action:PC.actionParameter,data:"content",id:t},context:this}).done(function(e){this.modal.$el.removeClass("loading"),n.isObject(e)&&e.content?(this.contents=PC.fe.setContent.parse(e),PC.fe.products_content[t]=this.contents,e.conditions&&(PC.productData["prod_"+t]=PC.productData["prod_"+t]||{},PC.productData["prod_"+t].conditions=e.conditions),a(PC.fe).trigger("variation_content_loaded",{response:e,product_id:t}),wp.hooks.doAction("variation_content_loaded",{response:e,product_id:t}),this.modal.$el.trigger("content-is-loaded")):(alert("Couldn't load Data for this product."),1!=PC.fe.inline&&this.modal.remove())}).fail(function(){console.log("error"),this.modal.$el.addClass("loading")}))},PC.fe.fetchedContent=function(e,t,o){console.log("fetched content")},PC.fe.setConfig=function(e){PC.fe.is_setting_config=!0,wp.hooks.doAction("PC.fe.setConfig.before",e),PC.fe.contents.content.resetConfig(),a.each(e,function(e,t){try{var o=PC.fe.layers.get(t.layer_id);o&&"group"==o.get("type")||(PC.fe.getLayerContent(t.layer_id)&&PC.fe.getLayerContent(t.layer_id).selectChoice&&PC.fe.getLayerContent(t.layer_id).selectChoice(t.choice_id,!0),wp.hooks.doAction("PC.fe.setConfig.setItem",t,PC.fe.getLayerContent(t.layer_id)))}catch(e){console.log("Product configurator - setConfig: Could not set this layer:",t.layer_id,e)}}),wp.hooks.doAction("PC.fe.setConfig",e),PC.fe.is_setting_config=!1},a(document).on("yith_wacp_adding_cart_single",function(){PC&&PC.fe&&PC.fe.modal&&PC.fe.modal.$el.addClass("adding-to-cart")}),a(document).on("yith_wacp_popup_after_opening",function(){PC&&PC.fe&&PC.fe.modal&&PC.fe.modal.$el.removeClass("adding-to-cart")})}(jQuery,PC._us||window._),PC.utils=PC.utils||{_isTouch:function(){return"ontouchstart"in window||0<navigator.msMaxTouchPoints||navigator.maxTouchPoints},_isMobile:function(){return!!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|playbook|silk|BlackBerry|BB10|Windows Phone|Tizen|Bada|webOS|IEMobile|Opera Mini)/)},formatMoney:function(e,t){return(t=void 0===t?!0:t)&&(e=this.maybeConvertAmountToCurrency(e)),"undefined"==typeof accounting?e:accounting.formatMoney(e,{precision:PC_config.lang.money_precision,symbol:PC_config.lang.money_symbol,decimal:PC_config.lang.money_decimal,thousand:PC_config.lang.money_thousand,format:PC_config.lang.money_format})},maybeConvertAmountToCurrency:function(e){var t;return"undefined"!=typeof woocs_current_currency&&"undefined"!=woocs_current_currency.rate?e*woocs_current_currency.rate:void 0!==PC.fe.config.wcml_rate&&parseFloat(PC.fe.config.wcml_rate)?e*parseFloat(PC.fe.config.wcml_rate):"undefined"!=typeof wc_aelia_currency_switcher_params&&"undefined"!=wc_aelia_currency_switcher_params.current_exchange_rate_from_base&&0<parseFloat(wc_aelia_currency_switcher_params.current_exchange_rate_from_base)?e*parseFloat(wc_aelia_currency_switcher_params.current_exchange_rate_from_base):void 0!==PC.fe.config.wcpbc_rate&&parseFloat(PC.fe.config.wcpbc_rate)?(t=e*parseFloat(PC.fe.config.wcpbc_rate),PC.fe.config.wcpbc_round_nearest?Math.ceil(t/PC.fe.config.wcpbc_round_nearest)*PC.fe.config.wcpbc_round_nearest:t):e},add_language_filters:function(t){function e(e){return e["name_"+t]&&""!=e["name_"+t].trim()&&(e.name=e["name_"+t]),e["description_"+t]&&""!=e["description_"+t].trim()&&(e.description=e["description_"+t]),e}wp.hooks.addFilter("PC.fe.configurator.layer_data","mkl/product_configurator",e,10),wp.hooks.addFilter("PC.fe.configurator.choice_data","mkl/product_configurator",e,10),wp.hooks.addFilter("PC.fe.configurator.angle_data","mkl/product_configurator",e,10)},strip_html:function(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}};